# ğŸ§ª ìœ ë‹› í…ŒìŠ¤íŠ¸ ì„¤ê³„ì„œ: Feature 3 - ë°˜ë³µ ì¼ì • ì¢…ë£Œ ì¡°ê±´

## 1. í…ŒìŠ¤íŠ¸ ëª©ì 

ë°˜ë³µ ì¼ì •ì˜ ì¢…ë£Œ ë‚ ì§œ ê´€ë ¨ ìˆœìˆ˜ í•¨ìˆ˜ë“¤ì´ ì˜¬ë°”ë¥´ê²Œ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
- ì¢…ë£Œ ë‚ ì§œ ê²€ì¦ ë¡œì§ì˜ ì •í™•ì„±
- ê¸°ë³¸ê°’ ë° ìµœëŒ€ê°’ ì²˜ë¦¬ ë¡œì§ì˜ ì •í™•ì„±
- ì¢…ë£Œ ë‚ ì§œê¹Œì§€ ë°˜ë³µ ì¼ì • ìƒì„± ë¡œì§ì˜ ì •í™•ì„±

## 2. í…ŒìŠ¤íŠ¸ ë²”ìœ„

### í¬í•¨
- `validateRepeatEndDate`: ì¢…ë£Œ ë‚ ì§œ ê²€ì¦ í•¨ìˆ˜
- `getRepeatEndDate`: ê¸°ë³¸ê°’/ìµœëŒ€ê°’ ì ìš© í•¨ìˆ˜
- `generateRecurringEventsUntilEndDate`: ì¢…ë£Œ ë‚ ì§œê¹Œì§€ ìƒì„± í•¨ìˆ˜

### ì œì™¸
- UI ë Œë”ë§ ë¡œì§
- API í˜¸ì¶œ ë¡œì§
- React ì»´í¬ë„ŒíŠ¸ ë° í›…

## 3. í…ŒìŠ¤íŠ¸ ë¶„ë¥˜

| êµ¬ë¶„        | ì„¤ëª…                                |
| ----------- | ----------------------------------- |
| ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ | ìˆœìˆ˜ í•¨ìˆ˜ì˜ ì…ë ¥-ì¶œë ¥ ê²€ì¦          |
| í†µí•© í…ŒìŠ¤íŠ¸ | (ì œì™¸) UI ë° API í†µí•©ì€ ë³„ë„ ê²€ì¦  |

---

## 4. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### í•¨ìˆ˜ 1: `validateRepeatEndDate`

**ìœ„ì¹˜**: `src/utils/repeatValidation.ts` (ì‹ ê·œ íŒŒì¼)

**í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜**:
```typescript
function validateRepeatEndDate(
  startDate: string,
  endDate: string | undefined
): { valid: boolean; error?: string }
```

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:

| TC ID | ì„¤ëª… | ì…ë ¥ | ê¸°ëŒ€ ê²°ê³¼ | í…ŒìŠ¤íŠ¸ ìœ í˜• |
|-------|------|------|-----------|-------------|
| TC-V-1 | ì¢…ë£Œ ë‚ ì§œê°€ ì‹œì‘ ë‚ ì§œë³´ë‹¤ ì´ì „ì´ë©´ invalid | startDate: "2025-10-15"<br>endDate: "2025-10-10" | `{ valid: false, error: "ì¢…ë£Œ ë‚ ì§œëŠ” ì‹œì‘ ë‚ ì§œ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤" }` | ë‹¨ìœ„ |
| TC-V-2 | ì¢…ë£Œ ë‚ ì§œê°€ ì‹œì‘ ë‚ ì§œì™€ ê°™ìœ¼ë©´ valid | startDate: "2025-10-15"<br>endDate: "2025-10-15" | `{ valid: true }` | ë‹¨ìœ„ |
| TC-V-3 | ì¢…ë£Œ ë‚ ì§œê°€ ì‹œì‘ ë‚ ì§œë³´ë‹¤ ì´í›„ë©´ valid | startDate: "2025-10-15"<br>endDate: "2025-10-20" | `{ valid: true }` | ë‹¨ìœ„ |
| TC-V-4 | ì¢…ë£Œ ë‚ ì§œê°€ undefinedë©´ valid (ê¸°ë³¸ê°’ ì ìš©) | startDate: "2025-10-15"<br>endDate: undefined | `{ valid: true }` | ë‹¨ìœ„ |
| TC-V-5 | ì¢…ë£Œ ë‚ ì§œê°€ ë¹ˆ ë¬¸ìì—´ì´ë©´ valid (ê¸°ë³¸ê°’ ì ìš©) | startDate: "2025-10-15"<br>endDate: "" | `{ valid: true }` | ë‹¨ìœ„ |
| TC-V-6 | ì˜ëª»ëœ ë‚ ì§œ í˜•ì‹ì´ë©´ invalid | startDate: "2025-10-15"<br>endDate: "invalid-date" | `{ valid: false, error: "ì˜¬ë°”ë¥¸ ë‚ ì§œ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤" }` | ë‹¨ìœ„ |

---

### í•¨ìˆ˜ 2: `getRepeatEndDate`

**ìœ„ì¹˜**: `src/utils/repeatDateUtils.ts`

**í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜**:
```typescript
function getRepeatEndDate(
  endDate: string | undefined
): string
```

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:

| TC ID | ì„¤ëª… | ì…ë ¥ | ê¸°ëŒ€ ê²°ê³¼ | í…ŒìŠ¤íŠ¸ ìœ í˜• |
|-------|------|------|-----------|-------------|
| TC-G-1 | undefinedë©´ ê¸°ë³¸ê°’ ë°˜í™˜ | endDate: undefined | `"2025-12-31"` | ë‹¨ìœ„ |
| TC-G-2 | nullì´ë©´ ê¸°ë³¸ê°’ ë°˜í™˜ | endDate: null | `"2025-12-31"` | ë‹¨ìœ„ |
| TC-G-3 | ë¹ˆ ë¬¸ìì—´ì´ë©´ ê¸°ë³¸ê°’ ë°˜í™˜ | endDate: "" | `"2025-12-31"` | ë‹¨ìœ„ |
| TC-G-4 | ìœ íš¨í•œ ë‚ ì§œë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜ | endDate: "2025-10-31" | `"2025-10-31"` | ë‹¨ìœ„ |
| TC-G-5 | ìµœëŒ€ê°’(2025-12-31)ì´ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜ | endDate: "2025-12-31" | `"2025-12-31"` | ë‹¨ìœ„ |
| TC-G-6 | ìµœëŒ€ê°’ ì´ˆê³¼í•˜ë©´ ìµœëŒ€ê°’ ë°˜í™˜ | endDate: "2026-01-01" | `"2025-12-31"` | ë‹¨ìœ„ |
| TC-G-7 | í›¨ì”¬ ë¯¸ë˜ ë‚ ì§œë„ ìµœëŒ€ê°’ìœ¼ë¡œ ì œí•œ | endDate: "2027-12-31" | `"2025-12-31"` | ë‹¨ìœ„ |
| TC-G-8 | ê³¼ê±° ë‚ ì§œëŠ” ê·¸ëŒ€ë¡œ ë°˜í™˜ (ì‹œì‘ ë‚ ì§œ ê²€ì¦ì€ ë³„ë„) | endDate: "2024-12-31" | `"2024-12-31"` | ë‹¨ìœ„ |

---

### í•¨ìˆ˜ 3: `generateRecurringEventsUntilEndDate`

**ìœ„ì¹˜**: `src/utils/repeatScheduler.ts` (ê¸°ì¡´ íŒŒì¼ í™•ì¥)

**í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜**:
```typescript
function generateRecurringEventsUntilEndDate(
  baseEvent: Event | EventForm,
  endDate: string
): Event[]
```

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:

| TC ID | ì„¤ëª… | ì…ë ¥ | ê¸°ëŒ€ ê²°ê³¼ | í…ŒìŠ¤íŠ¸ ìœ í˜• |
|-------|------|------|-----------|-------------|
| TC-R-1 | ë§¤ì¼ ë°˜ë³µ, 5ì¼ê°„ | startDate: "2025-10-01"<br>repeat: daily<br>endDate: "2025-10-05" | 5ê°œ ì´ë²¤íŠ¸ ìƒì„±<br>ë‚ ì§œ: 10/1~10/5 | ë‹¨ìœ„ |
| TC-R-2 | ë§¤ì¼ ë°˜ë³µ, 10ì¼ê°„ | startDate: "2025-10-01"<br>repeat: daily<br>endDate: "2025-10-10" | 10ê°œ ì´ë²¤íŠ¸<br>ë§ˆì§€ë§‰: 10/10 | ë‹¨ìœ„ |
| TC-R-3 | ë§¤ì£¼ ë°˜ë³µ, 1ê°œì›” | startDate: "2025-10-01"<br>repeat: weekly<br>endDate: "2025-10-31" | 5ê°œ ì´ë²¤íŠ¸<br>(10/1, 10/8, 10/15, 10/22, 10/29) | ë‹¨ìœ„ |
| TC-R-4 | ë§¤ì›” ë°˜ë³µ, 3ê°œì›” | startDate: "2025-10-01"<br>repeat: monthly<br>endDate: "2025-12-31" | 3ê°œ ì´ë²¤íŠ¸<br>(10/1, 11/1, 12/1) | ë‹¨ìœ„ |
| TC-R-5 | ì—°ê°„ ë°˜ë³µ, ê°™ì€ í•´ | startDate: "2025-10-01"<br>repeat: yearly<br>endDate: "2025-12-31" | 1ê°œ ì´ë²¤íŠ¸ (10/1ë§Œ) | ë‹¨ìœ„ |
| TC-R-6 | ì¢…ë£Œ ë‚ ì§œ = ì‹œì‘ ë‚ ì§œ | startDate: "2025-10-15"<br>repeat: daily<br>endDate: "2025-10-15" | 1ê°œ ì´ë²¤íŠ¸ (10/15ë§Œ) | ë‹¨ìœ„ |
| TC-R-7 | ì¢…ë£Œ ë‚ ì§œê°€ ì²« ë°˜ë³µ ì „ (ê²½ê³„ê°’) | startDate: "2025-10-01"<br>repeat: weekly<br>endDate: "2025-10-02" | 1ê°œ ì´ë²¤íŠ¸ (10/1ë§Œ) | ë‹¨ìœ„ |

---

## 5. í…ŒìŠ¤íŠ¸ ë°ì´í„°

### Mock Event for Testing
```typescript
const baseEvent: EventForm = {
  title: 'í…ŒìŠ¤íŠ¸ ì´ë²¤íŠ¸',
  date: '2025-10-01',
  startTime: '10:00',
  endTime: '11:00',
  description: 'Unit test',
  location: 'Test',
  category: 'í…ŒìŠ¤íŠ¸',
  repeat: {
    type: 'daily', // í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ë³€ê²½
    interval: 1,
  },
  notificationTime: 10,
};
```

## 6. ê²€ì¦ ê¸°ì¤€ (Assertion Points)

### `validateRepeatEndDate`
- [ ] ë‚ ì§œ ë¹„êµ ë¡œì§ì´ ì •í™•í•¨
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ê°€ ëª…í™•í•¨
- [ ] undefined/null/ë¹ˆ ë¬¸ìì—´ì„ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬
- [ ] ì˜ëª»ëœ í˜•ì‹ ê°ì§€

### `getRepeatEndDate`
- [ ] ê¸°ë³¸ê°’(2025-12-31)ì´ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë¨
- [ ] ìµœëŒ€ê°’ ì œí•œì´ ì˜¬ë°”ë¥´ê²Œ ë™ì‘
- [ ] ìœ íš¨í•œ ë‚ ì§œëŠ” ë³€ê²½ë˜ì§€ ì•ŠìŒ
- [ ] null safety (undefined, null, "" ì²˜ë¦¬)

### `generateRecurringEventsUntilEndDate`
- [ ] ìƒì„±ëœ ì´ë²¤íŠ¸ ê°œìˆ˜ê°€ ì •í™•í•¨
- [ ] ë§ˆì§€ë§‰ ì´ë²¤íŠ¸ ë‚ ì§œê°€ endDate ì´í•˜
- [ ] endDate + 1ì¼ ì´ë²¤íŠ¸ëŠ” ìƒì„±ë˜ì§€ ì•ŠìŒ
- [ ] ê° ë°˜ë³µ ìœ í˜•(daily, weekly, monthly, yearly)ì´ ì˜¬ë°”ë¥´ê²Œ ë™ì‘
- [ ] ê²½ê³„ê°’ ì²˜ë¦¬ê°€ ì •í™•í•¨

## 7. ì—£ì§€ ì¼€ì´ìŠ¤ ë° ê²½ê³„ê°’

### `validateRepeatEndDate`
| ì¼€ì´ìŠ¤ | ì…ë ¥ | ê¸°ëŒ€ ë™ì‘ |
|--------|------|-----------|
| ì¢…ë£Œ = ì‹œì‘ | start: "2025-10-15", end: "2025-10-15" | valid: true |
| ì¢…ë£Œ = ì‹œì‘ - 1ì¼ | start: "2025-10-15", end: "2025-10-14" | valid: false |
| ìœ¤ë…„ ë‚ ì§œ | start: "2024-02-28", end: "2024-02-29" | valid: true |
| 12ì›” 31ì¼ | start: "2025-12-31", end: "2025-12-31" | valid: true |

### `getRepeatEndDate`
| ì¼€ì´ìŠ¤ | ì…ë ¥ | ê¸°ëŒ€ ë™ì‘ |
|--------|------|-----------|
| ì •í™•íˆ ìµœëŒ€ê°’ | "2025-12-31" | "2025-12-31" |
| ìµœëŒ€ê°’ + 1ì¼ | "2026-01-01" | "2025-12-31" |
| ìµœëŒ€ê°’ - 1ì¼ | "2025-12-30" | "2025-12-30" |
| ê³¼ê±° ë‚ ì§œ | "2024-01-01" | "2024-01-01" (ì‹œì‘ ë‚ ì§œ ê²€ì¦ì€ ë³„ë„) |

### `generateRecurringEventsUntilEndDate`
| ì¼€ì´ìŠ¤ | ì…ë ¥ | ê¸°ëŒ€ ë™ì‘ |
|--------|------|-----------|
| ì¢…ë£Œ = ì‹œì‘ | start: "2025-10-15", end: "2025-10-15", daily | 1ê°œ |
| ì¢…ë£Œ = ì‹œì‘ + 1ì¼ | start: "2025-10-15", end: "2025-10-16", daily | 2ê°œ |
| ì›”ë§ â†’ ë‹¤ìŒ ë‹¬ | start: "2025-10-31", end: "2025-11-30", monthly | 2ê°œ (10/31, 11/30) |
| ìœ¤ë…„ 2ì›” | start: "2024-02-29", end: "2024-03-31", monthly | 2ê°œ (2/29, 3/29) |

## 8. ë¹„ê³ 

### êµ¬í˜„ ì‹œ ê³ ë ¤ì‚¬í•­
- ë‚ ì§œ ë¹„êµëŠ” `new Date().getTime()` ì‚¬ìš©
- ìµœëŒ€ê°’(2025-12-31)ì€ ìƒìˆ˜ë¡œ ì •ì˜ (`const MAX_REPEAT_END_DATE = '2025-12-31'`)
- í•¨ìˆ˜ëŠ” ìˆœìˆ˜ í•¨ìˆ˜ë¡œ êµ¬í˜„ (side effect ì—†ìŒ)
- íƒ€ì„ì¡´ ì´ìŠˆ ë°©ì§€: UTC ë˜ëŠ” ë¡œì»¬ ë‚ ì§œ ì¼ê´€ì„± ìœ ì§€

### í…ŒìŠ¤íŠ¸ ì½”ë“œ êµ¬ì¡°
```typescript
describe('repeatValidation', () => {
  describe('validateRepeatEndDate', () => {
    it('TC-V-1: ì¢…ë£Œ ë‚ ì§œê°€ ì‹œì‘ ë‚ ì§œë³´ë‹¤ ì´ì „ì´ë©´ invalid', () => {
      const result = validateRepeatEndDate('2025-10-15', '2025-10-10');
      expect(result.valid).toBe(false);
      expect(result.error).toBe('ì¢…ë£Œ ë‚ ì§œëŠ” ì‹œì‘ ë‚ ì§œ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤');
    });
    // ... ë” ë§ì€ í…ŒìŠ¤íŠ¸
  });
});

describe('repeatDateUtils', () => {
  describe('getRepeatEndDate', () => {
    it('TC-G-1: undefinedë©´ ê¸°ë³¸ê°’ ë°˜í™˜', () => {
      const result = getRepeatEndDate(undefined);
      expect(result).toBe('2025-12-31');
    });
    // ... ë” ë§ì€ í…ŒìŠ¤íŠ¸
  });
});

describe('repeatScheduler', () => {
  describe('generateRecurringEventsUntilEndDate', () => {
    it('TC-R-1: ë§¤ì¼ ë°˜ë³µ, 5ì¼ê°„', () => {
      const events = generateRecurringEventsUntilEndDate(baseEvent, '2025-10-05');
      expect(events).toHaveLength(5);
      expect(events[0].date).toBe('2025-10-01');
      expect(events[4].date).toBe('2025-10-05');
    });
    // ... ë” ë§ì€ í…ŒìŠ¤íŠ¸
  });
});
```

---

**í…ŒìŠ¤íŠ¸ ì„¤ê³„ ì™„ë£Œì¼**: 2025-10-30  
**ì´ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜**: 3ê°œ  
**ì´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**: 21ê°œ (TC-V: 6, TC-G: 8, TC-R: 7)  
**í…ŒìŠ¤íŠ¸ ìœ í˜•**: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 100%

