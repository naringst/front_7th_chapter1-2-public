# Feature 4 Breakdown: 반복 일정 수정

## 1. Epic 정의

**Epic 이름**: 반복 일정 수정 관리

**Epic 설명**:
사용자가 반복 일정을 수정할 때, 해당 일정만 수정할지 전체 반복 일정을 수정할지 선택할 수 있는 기능을 제공합니다. 단일 수정 시에는 반복 속성이 제거되어 일반 일정으로 전환되고, 전체 수정 시에는 반복 속성이 유지됩니다.

**관련 PRD**: FEATURE4.md

---

## 2. Story 분해

| Story ID | Story 이름 | 설명 | 우선순위 |
|----------|-----------|------|----------|
| Story-4-1 | 단일 반복 일정 수정 | 사용자가 "해당 일정만 수정하시겠어요?"에서 "예"를 선택하여 단일 일정으로 변경 | High |
| Story-4-2 | 전체 반복 일정 수정 | 사용자가 "해당 일정만 수정하시겠어요?"에서 "아니오"를 선택하여 전체 반복 일정 수정 | High |
| Story-4-3 | 수정 확인 다이얼로그 표시 | 반복 일정 수정 시 선택 다이얼로그 표시 | High |

---

## 3. Flow 분해

### Story-4-1: 단일 반복 일정 수정

| Flow ID | Flow 이름 | Input | Trigger | Output | 분류 |
|---------|-----------|-------|---------|--------|------|
| F-4-1-1 | 단일 수정 - 일정 속성 변경 | - 반복 일정 선택<br>- 수정 버튼 클릭<br>- 다이얼로그에서 "예" 선택<br>- 제목, 날짜, 시간 수정<br>- 저장 버튼 클릭 | 사용자가 단일 일정 수정을 선택하고 저장 | - 선택한 일정만 수정됨<br>- `repeat.type = 'none'`으로 변경<br>- 반복 일정 아이콘 사라짐<br>- API PUT 호출 (`/api/events/{id}`) | Normal |
| F-4-1-2 | 단일 수정 - 반복 아이콘 제거 확인 | - 반복 일정 선택<br>- 수정 후 "예" 선택<br>- 저장 완료 | 단일 수정 후 UI 확인 | - 수정된 일정에 반복 아이콘 없음<br>- 다른 반복 일정들은 아이콘 유지 | Normal |
| F-4-1-3 | 단일 수정 - 나머지 반복 일정 유지 | - 매주 월요일 반복 일정 (총 4개)<br>- 두 번째 일정 선택<br>- 수정 후 "예" 선택 | 단일 수정 시 나머지 반복 일정 확인 | - 두 번째 일정만 수정됨<br>- 나머지 3개 일정은 원래 속성 유지 | Normal |

### Story-4-2: 전체 반복 일정 수정

| Flow ID | Flow 이름 | Input | Trigger | Output | 분류 |
|---------|-----------|-------|---------|--------|------|
| F-4-2-1 | 전체 수정 - 모든 반복 일정 속성 변경 | - 반복 일정 선택<br>- 수정 버튼 클릭<br>- 다이얼로그에서 "아니오" 선택<br>- 제목, 시간 수정<br>- 저장 버튼 클릭 | 사용자가 전체 반복 일정 수정을 선택하고 저장 | - 같은 반복 그룹의 모든 일정이 수정됨<br>- `repeat.type` 유지<br>- 반복 일정 아이콘 유지<br>- API 일괄 수정 또는 개별 PUT 호출 | Normal |
| F-4-2-2 | 전체 수정 - 반복 아이콘 유지 확인 | - 반복 일정 수정 후 "아니오" 선택<br>- 저장 완료 | 전체 수정 후 UI 확인 | - 모든 반복 일정에 아이콘 유지<br>- 수정된 속성이 모든 일정에 반영 | Normal |
| F-4-2-3 | 전체 수정 - 반복 유형 유지 | - 매주 수요일 반복 일정<br>- 시간만 수정 후 "아니오" 선택 | 전체 수정 시 반복 속성 확인 | - 모든 일정의 `repeat.type = 'weekly'` 유지<br>- 수정된 시간이 모든 일정에 적용 | Normal |

### Story-4-3: 수정 확인 다이얼로그 표시

| Flow ID | Flow 이름 | Input | Trigger | Output | 분류 |
|---------|-----------|-------|---------|--------|------|
| F-4-3-1 | 다이얼로그 표시 | - 반복 일정 선택<br>- 수정 버튼 클릭 | 반복 일정 수정 시작 | - "해당 일정만 수정하시겠어요?" 다이얼로그 표시<br>- "예" 버튼 표시<br>- "아니오" 버튼 표시 | Normal |
| F-4-3-2 | 다이얼로그에서 "예" 선택 | - 다이얼로그 표시됨<br>- "예" 버튼 클릭 | 단일 수정 선택 | - 다이얼로그 닫힘<br>- 일정 수정 폼으로 진행<br>- 단일 수정 모드 활성화 | Normal |
| F-4-3-3 | 다이얼로그에서 "아니오" 선택 | - 다이얼로그 표시됨<br>- "아니오" 버튼 클릭 | 전체 수정 선택 | - 다이얼로그 닫힘<br>- 일정 수정 폼으로 진행<br>- 전체 수정 모드 활성화 | Normal |
| F-4-3-4 | 일반 일정 수정 시 다이얼로그 미표시 | - 일반 일정 (repeat.type = 'none') 선택<br>- 수정 버튼 클릭 | 일반 일정 수정 시작 | - 다이얼로그 표시되지 않음<br>- 바로 일정 수정 폼 표시 | Normal |

---

## 4. 요약

### Epic 요약
- **Epic**: 반복 일정 수정 관리
- **Story 개수**: 3개
- **Flow 개수**: 10개 (Normal: 10, Exception: 0)

### Story별 Flow 분포
| Story | Normal | Exception | 총 Flow |
|-------|--------|-----------|---------|
| Story-4-1: 단일 반복 일정 수정 | 3 | 0 | 3 |
| Story-4-2: 전체 반복 일정 수정 | 3 | 0 | 3 |
| Story-4-3: 수정 확인 다이얼로그 표시 | 4 | 0 | 4 |
| **합계** | **10** | **0** | **10** |

### 핵심 기술 요구사항
1. **다이얼로그 UI**: MUI Dialog를 사용한 선택 확인
2. **조건부 수정**: 단일/전체 모드에 따른 분기 처리
3. **반복 속성 관리**: `repeat.type` 변경 및 유지
4. **반복 그룹 식별**: 같은 반복 일정 그룹 찾기 (제목, 시작시간, 반복 유형 등으로 식별)
5. **UI 업데이트**: 아이콘 표시/숨김 처리

### 예상 구현 파일
- **UI**: `src/App.tsx` (다이얼로그 추가)
- **Hook**: `src/hooks/useEventOperations.ts` (수정 로직 확장)
- **Utility**: `src/utils/repeatGroupUtils.ts` (반복 그룹 식별, 신규)
- **Test**: `src/__tests__/integration/feature4-integration.spec.tsx`

---

**작성일**: 2025-10-30  
**Feature**: FEATURE4 - 반복 일정 수정  
**Epic**: 1개 | Stories**: 3개 | **Flows**: 10개

